(this.webpackJsonpadmin=this.webpackJsonpadmin||[]).push([[0],{23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),l=n(17),o=n.n(l),i=(n(23),n(5)),s=(n(24),n(25),n(18)),r=n.n(s),d=localStorage.getItem("token"),j=r.a.create({baseURL:"https://www.kevinstonge.com",withCredentials:!0,headers:{authorization:"Bearer ".concat(d)}}),u=n(0);function p(e){var t=e.page,n=e.setPage;return Object(u.jsxs)("header",{children:[Object(u.jsxs)("nav",{children:[Object(u.jsx)("button",{className:"projects"===t?"nav, active":"nav, inactive",onClick:function(){return n("projects")},disabled:"projects"===t,children:"projects"}),Object(u.jsx)("button",{className:"skills"===t?"nav, active":"nav, inactive",onClick:function(){return n("skills")},disabled:"skills"===t,children:"skills"})]}),Object(u.jsx)("nav",{children:Object(u.jsx)("button",{onClick:function(){e.setToken(null),localStorage.removeItem("token")},children:"log out"})})]})}var b=n(1),m=n(4),g={id:"new",title:"",description:"",image:null,url:"",github:"",rank:0,localImage:"".concat("https://www.kevinstonge.com","/images/defaultLogo.png"),skills:[]};function h(e){var t=e.project,n=e.projectForm,c=e.setProjectForm,a=e.index,l=e.skills,o=!Object.entries(n.local[a]).map((function(e){return e[1]===n.saved[a][e[0]]})).some((function(e){return!1===e})),i={apply:0===n.local[a].title.length||0===n.local[a].url.length||o,revert:o},s=function(e){var t=Object(b.a)({},n);t.local[a][e.target.name]=e.target.value,"image"===e.target.name&&(t.local[a].localImage=URL.createObjectURL(e.target.files[0])),c(t)},r=function(e,l){if(200===e.status||201===e.status){var o,i=Object(b.a)({},n);if(null===(o=e.data)||void 0===o?void 0:o.addedProject){var s=e.data.addedProject[0];i.local[0]=g,i.local.push(Object(b.a)(Object(b.a)({},t),{},{id:s})),i.saved.push(Object(b.a)(Object(b.a)({},t),{},{id:s}))}else"delete"===l?(i.local.splice(a,1),i.saved.splice(a,1)):i.saved=Object(m.a)(i.local.map((function(e){return Object(b.a)({},e)})));c(i)}else console.log("error: unexpected response from server")};return Object(u.jsxs)("form",{className:"projectForm",onSubmit:function(e){e.preventDefault(),e.persist(),function(e){var c=n.local[a].image!==n.saved[a].image,l=c?"multipart/form":"application/x-www-form-urlencoded",o=0===a?"post":"put",i=0===a?"/api/portfolio/projects/":"/api/portfolio/projects/".concat(t.id),s=new FormData;s.append("title",e.target.title.value),s.append("description",e.target.description.value),s.append("url",e.target.url.value),s.append("github",e.target.github.value),s.append("skills",JSON.stringify(n.local[a].skills)),c&&s.append("image",e.target.image.files[0]),console.log("axios URL: ",i),j({method:o,headers:{"Content-Type":l},url:i,data:s}).then((function(e){r(e,o)}))}(e)},children:[Object(u.jsxs)("div",{className:"column",children:[Object(u.jsxs)("label",{htmlFor:"project-".concat(t.id,"-title"),children:[Object(u.jsx)("p",{children:"title*:"}),Object(u.jsx)("input",{type:"text",value:t.title,name:"title",id:"project-".concat(t.id,"-title"),onChange:function(e){e.persist(),s(e)}})]}),Object(u.jsxs)("label",{htmlFor:"project-".concat(t.id,"-image"),children:[Object(u.jsx)("p",{children:"image:"}),Object(u.jsx)("img",{src:n.local[a].localImage,alt:"".concat(n.local[a].title),className:"project-image"}),Object(u.jsx)("input",{id:"project-".concat(t.id,"-image"),name:"image",type:"file",onChange:function(e){e.persist(),s(e)}})]})]}),Object(u.jsx)("div",{className:"column",children:Object(u.jsxs)("label",{htmlFor:"project-".concat(t.id,"-description"),children:[Object(u.jsx)("p",{children:"description:"}),Object(u.jsx)("textarea",{value:t.description,name:"description",id:"project-".concat(t.id,"-description"),onChange:function(e){e.persist(),s(e)}})]})}),Object(u.jsxs)("div",{className:"column",children:[Object(u.jsxs)("label",{htmlFor:"project-".concat(t.id,"-url"),children:[Object(u.jsx)("p",{children:"url:"}),Object(u.jsx)("input",{type:"text",value:t.url,name:"url",id:"project-".concat(t.id,"-url"),onChange:function(e){e.persist(),s(e)}})]}),Object(u.jsxs)("label",{htmlFor:"project-".concat(t.id,"-github"),children:[Object(u.jsx)("p",{children:"github:"}),Object(u.jsx)("input",{type:"text",value:t.github,name:"github",id:"project-".concat(t.id,"-github"),onChange:function(e){e.persist(),s(e)}})]}),"new"!==t.id&&Object(u.jsxs)("label",{htmlFor:"project-".concat(t.id,"-rank"),children:[Object(u.jsxs)("p",{children:["rank (",t.rank,"):"]}),Object(u.jsx)("button",{id:"project=".concat(t.id,"-rank"),disabled:1===t.rank,onClick:function(e){e.persist(),function(e){var l=new FormData,o=t.rank,i=o-1;l.append("rank",i),j({method:"put",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:"/api/portfolio/projects/".concat(t.id),data:l}).then((function(e){var l=Object(b.a)({},n);l.local[a].rank=i,l.local.forEach((function(e,n){e.id&&e.id!==t.id&&"new"!==e.id&&e.rank>=i&&e.rank<o&&(l.local[n].rank+=1)})),c(l),r(e,"put")}))}()},children:"promote"})]})]}),Object(u.jsxs)("div",{className:"form-buttons",children:[Object(u.jsx)("button",{type:"submit",className:"apply",disabled:i.apply,children:"new"===t.id?"add":"apply"}),Object(u.jsx)("button",{disabled:i.revert,className:"revert",onClick:function(e){e.preventDefault(),e.persist(),function(e){var t=Object(b.a)({},n);t.local[a]=Object(b.a)({},n.saved[a]),c(t)}()},children:"revert"}),0!==a&&Object(u.jsx)("button",{className:"delete",onClick:function(e){e.preventDefault(),e.persist(),j.delete("/api/portfolio/projects/".concat(t.id),{data:"asdf"}).then((function(e){200===e.status?r(e,"delete"):console.log("server error")})).catch((function(e){return console.log(e)}))},children:"delete"})]}),l.length>0&&Object(u.jsxs)("fieldset",{id:"form-footer",children:[Object(u.jsx)("p",{children:"Skills:"}),l&&l.length>0&&l.map((function(e){var l="p".concat(t.id,"-s").concat(e.id);return Object(u.jsxs)("label",{htmlFor:l,className:"checkbox-label",children:[Object(u.jsx)("input",{type:"checkbox",name:"skills",id:l,value:e.id,checked:n.local[a].skills.includes(e.id),onChange:function(e){e.persist(),function(e){var t=parseInt(e.target.value),l=Object(b.a)({},n),o=Object(m.a)(l.local[a].skills);-1===o.indexOf(t)?o.push(t):o.splice(o.indexOf(t),1),l.local[a].skills=o,c(l)}(e)}}),Object(u.jsx)("p",{children:e.short_name})]},l)}))]})]},"project-".concat(t.id))}function f(){var e="https://www.kevinstonge.com/images",t=Object(c.useState)({saved:[],local:[]}),n=Object(i.a)(t,2),a=n[0],l=n[1],o=Object(c.useState)([]),s=Object(i.a)(o,2),r=s[0],d=s[1];return Object(c.useEffect)((function(){j.get("/api/portfolio/projects").then((function(t){var n=g;l({saved:[Object(b.a)({},n)].concat(Object(m.a)(t.data.projects.map((function(t){return Object(b.a)(Object(b.a)({},t),{},{localImage:null===t.image||""===t.image?"".concat(e,"/defaultImage.png"):"".concat(e,"/").concat(t.image)})})))),local:[Object(b.a)({},n)].concat(Object(m.a)(t.data.projects.map((function(t){return Object(b.a)(Object(b.a)({},t),{},{localImage:null===t.image||""===t.image?"".concat(e,"/defaultImage.png"):"".concat(e,"/").concat(t.image)})}))))}),d(t.data.skills)})).catch((function(e){return console.log(e)}))}),[]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h2",{children:"Projects"}),a.local.length>0&&a.local.sort((function(e,t){return e.rank-t.rank})).map((function(e,t){return h({project:e,index:t,projectForm:a,setProjectForm:l,skills:r})})),Object(u.jsx)("p",{style:{fontSize:"smaller"},children:"*required"})]})}var O={id:"new",long_name:"",short_name:"",logo:null,localLogo:"".concat("https://www.kevinstonge.com","/images/defaultLogo.png"),proficiency:1};function v(e){var t=e.skill,n=e.index,c=e.skillForm,a=e.setSkillForm,l=!Object.entries(c.local[n]).map((function(e){return e[1]===c.saved[n][e[0]]})).some((function(e){return!1===e})),o={apply:0===c.local[n].long_name.length||l,revert:l},i=function(e){var t=Object(b.a)({},c);t.local[n][e.target.name]=e.target.value,parseInt(e.target.value)&&(t.local[n][e.target.name]=parseInt(e.target.value)),"logo"===e.target.name&&(t.local[n].localLogo=URL.createObjectURL(e.target.files[0])),a(t)},s=function(e,l){if(200===e.status||201===e.status){var o,i=Object(b.a)({},c);(null===(o=e.data)||void 0===o?void 0:o.addedSkillId)?(i.local[0]=O,i.local.push(Object(b.a)(Object(b.a)({},t),{},{id:e.data.addedSkillId})),i.saved.push(Object(b.a)(Object(b.a)({},t),{},{id:e.data.addedSkillId}))):"delete"===l?(i.local.splice(n,1),i.saved.splice(n,1)):i.saved=Object(m.a)(i.local.map((function(e){return Object(b.a)({},e)}))),a(i)}else console.log("error: unexpected response from server")};return Object(u.jsxs)("form",{className:"skillForm",onSubmit:function(e){e.preventDefault(),e.persist(),function(e){var a=c.local[n].logo===c.saved[n].logo?"multipart/form":"application/x-www-form-urlencoded",l=0===n?"post":"put",o=0===n?"api/portfolio/skills/":"api/portfolio/skills/".concat(t.id),i=new FormData;i.append("long_name",e.target.long_name.value),i.append("short_name",e.target.short_name.value),i.append("proficiency",e.target.proficiency.value),c.local[n].logo!==c.saved[n].logo&&i.append("logo",e.target.logo.files[0]),j({method:l,headers:{"Content-Type":a},url:o,data:i}).then((function(e){s(e,l)}))}(e)},children:[Object(u.jsxs)("label",{htmlFor:"skill-".concat(t.id,"-long_name"),children:[Object(u.jsx)("p",{children:"long name*:"}),Object(u.jsx)("input",{type:"text",value:c.local[n].long_name,id:"skill-".concat(t.id,"-long_name"),name:"long_name",className:c.local[n].long_name===c.saved[n].long_name?"unchanged":"changed",onChange:function(e){e.persist(),e.preventDefault(),i(e)}})]}),Object(u.jsxs)("label",{htmlFor:"skill-".concat(t.id,"-short_name"),children:[Object(u.jsx)("p",{children:"short name:"}),Object(u.jsx)("input",{type:"text",value:c.local[n].short_name,id:"skill-".concat(t.id,"-short_name"),name:"short_name",className:c.local[n].short_name===c.saved[n].short_name?"unchanged":"changed",onChange:function(e){e.persist(),e.preventDefault(),i(e)}})]}),Object(u.jsxs)("label",{htmlFor:"skill-".concat(t.id,"-logo"),style:{flex:0},children:[Object(u.jsx)("p",{children:"logo:"}),Object(u.jsx)("img",{src:c.local[n].localLogo,id:"skill".concat(t.id,"-img"),alt:"".concat(c.local[n].long_name,"-logo"),className:"logo"}),Object(u.jsx)("input",{id:"skill-".concat(t.id,"-logo"),name:"logo",type:"file",onChange:function(e){e.persist(),i(e)}})]}),Object(u.jsxs)("label",{htmlFor:"skill-".concat(t.id,"-proficiency"),children:[Object(u.jsx)("p",{children:"proficiency:"}),Object(u.jsxs)("select",{value:c.local[n].proficiency,id:"skill-".concat(t.id,"-proficiency"),name:"proficiency",className:c.local[n].proficiency===c.saved[n].proficiency?"unchanged":"changed",onChange:function(e){e.persist(),i(e)},children:[Object(u.jsx)("option",{value:1,children:"beginner"}),Object(u.jsx)("option",{value:2,children:"intermediate"}),Object(u.jsx)("option",{value:3,children:"advanced"}),Object(u.jsx)("option",{value:4,children:"expert"})]})]}),Object(u.jsxs)("span",{className:"form-buttons",children:[Object(u.jsx)("button",{type:"submit",className:"apply",disabled:o.apply,children:"new"===t.id?"add":"apply"}),Object(u.jsx)("button",{disabled:o.revert,className:"revert",onClick:function(e){e.preventDefault(),e.persist(),function(e){var t=Object(b.a)({},c);t.local[n]=Object(b.a)({},c.saved[n]),a(t)}()},children:"revert"}),0!==n&&Object(u.jsx)("button",{className:"delete",onClick:function(e){e.preventDefault(),e.persist(),j.delete("/api/portfolio/skills/".concat(t.id),{data:"asdf"}).then((function(e){200===e.status?s(e,"delete"):console.log("server error")})).catch((function(e){return console.log(e)}))},children:"delete"})]})]},"skill-".concat(t.id))}function x(){var e=Object(c.useState)({saved:[],local:[]}),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){j.get("/api/portfolio/skills").then((function(e){var t="".concat("https://www.kevinstonge.com","/images"),n=O;a({saved:[Object(b.a)({},n)].concat(Object(m.a)(e.data.skills.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{localLogo:null===e.logo?"".concat(t,"/defaultLogo.png"):"".concat(t,"/").concat(e.logo)})})))),local:[Object(b.a)({},n)].concat(Object(m.a)(e.data.skills.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{localLogo:null===e.logo?"".concat(t,"/defaultLogo.png"):"".concat(t,"/").concat(e.logo)})}))))})})).catch((function(e){return console.log(e)}))}),[]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h2",{children:"skills"}),n.local.length>0&&n.local.map((function(e,t){return v({skill:e,index:t,skillForm:n,setSkillForm:a})})),Object(u.jsx)("p",{style:{fontSize:"smaller"},children:"*required"})]})}function k(e){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Log in"}),Object(u.jsxs)("form",{onSubmit:function(t){return function(t){t.preventDefault(),j({method:"POST",url:"/admin/login",data:{username:t.target[0].value,password:t.target[1].value}}).then((function(t){var n=t.data.token;200===t.status&&n&&(e.setToken(n),localStorage.setItem("token",n)),console.log(t)})).catch(console.log)}(t)},children:[Object(u.jsx)("input",{type:"text",name:"username",id:"username"}),Object(u.jsx)("input",{type:"password",name:"password",id:"password"}),Object(u.jsx)("button",{type:"submit",children:"log in"})]})]})}var w=function(){var e=Object(c.useState)(null),t=Object(i.a)(e,2),n=t[0],a=t[1],l=Object(c.useState)("projects"),o=Object(i.a)(l,2),s=o[0],r=o[1];return Object(c.useEffect)((function(){a(localStorage.getItem("token"))}),[]),Object(u.jsx)("div",{id:"mainContainer",children:null===n?Object(u.jsx)(k,{setToken:a}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(p,{page:s,setPage:r,setToken:a}),Object(u.jsxs)("div",{id:"contentContainer",children:["projects"===s&&Object(u.jsx)(f,{}),"skills"===s&&Object(u.jsx)(x,{})]})]})})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,46)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,l=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),l(e),o(e)}))};o.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(w,{})}),document.getElementById("root")),y()}},[[45,1,2]]]);
//# sourceMappingURL=main.d9ad3f83.chunk.js.map